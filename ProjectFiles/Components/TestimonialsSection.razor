@using MyShowCase.Data.TestimonialsSectionModels
@using MyShowCase.Data
   <!-- TestimonialsSection -->
<section id="testimonials" class="testimonials section">
    <!-- Section Title -->
    <div class="container section-title">
        <h2>@Model.SectionTitle</h2>
        <p>@Model.SectionSubtitle</p>
    </div><!-- End Section Title -->

    <div class="container" data-aos="fade-up" data-aos-delay="100">

        <div class="row">
            <div class="col-12">
                <div class="critic-reviews" data-aos="fade-up" data-aos-delay="300">
                    <div class="row">
                        @foreach (var critic in Model.Critics)
                        {
                            <div class="col-md-4">
                                <div class="critic-review">
                                    <div class="review-quote">"</div>
                                    <div class="stars">
                                        @for (var i = 1; i <= 5; i++)
                                        {
                                            if (critic.Rating >= i)
                                            {
                                                <i class="bi bi-star-fill"></i>
                                                ;
                                            }
                                            else if (critic.Rating >= i - 0.5)
                                            {

                                                <i class="bi bi-star-half"></i>
                                                ;
                                            }
                                        }
                                    </div>
                                    <p>@critic.Quote</p>
                                    <div class="critic-info">
                                        <div class="critic-name">@critic.Source</div>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>

                <div class="testimonials-container">
                    <div class="swiper testimonials-slider init-swiper" data-aos="fade-up" data-aos-delay="400">
                        <script type="application/json" class="swiper-config">
                            {
                              "loop": true,
                              "speed": 600,
                              "autoplay": {
                                "delay": 5000
                              },
                              "slidesPerView": 1,
                              "spaceBetween": 30,
                              "pagination": {
                                "el": ".swiper-pagination",
                                "type": "bullets",
                                "clickable": true
                              },
                              "breakpoints": {
                                "768": {
                                  "slidesPerView": 2
                                },
                                "992": {
                                  "slidesPerView": 3
                                }
                              }
                            }
                        </script>

                        <div class="swiper-wrapper">
                            @foreach (var t in Model.Testimonials)
                            {
                                <div class="swiper-slide">
                                    <div class="testimonial-item">
                                        <div class="stars">
                                            @for (var i = 1; i <= 5; i++)
                                            {
                                                if (t.Rating >= i)
                                                {
                                                    <i class="bi bi-star-fill"></i>
                                                    ;
                                                }
                                                else if (t.Rating >= i - 0.5)
                                                {

                                                    <i class="bi bi-star-half"></i>
                                                    ;
                                                }
                                            }
                                        </div>
                                        <p>@t.Review</p>
                                        <div class="testimonial-profile">
                                            <img src="@t.ImageUrl" alt="@t.Name" class="img-fluid rounded-circle">
                                            <div>
                                                <h3>@t.Name</h3>
                                                <h4>@t.Title</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12 text-center" data-aos="fade-up">
                <div class="overall-rating">
                    <div class="rating-number">@Model.Summary.AverageRating.ToString("0.0")</div>
                    <div class="rating-stars">
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-half"></i>
                    </div>
                    <p>Based on @Model.Summary.ReviewCount+ reviews</p>
                    <div class="rating-platforms">
                        @foreach (var platform in Model.Summary.Platforms)
                        {
                            <span>@platform</span>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</section><!-- /Testimonials Section -->
@code {
    private TestimonialsSectionModel Model { get; set; }
    [Inject] private ContentStore Store { get; set; }
    [Parameter] public string? ContentId { get; set; }

    protected override async Task OnInitializedAsync()
    {
        Model = await Store.GetAsync<TestimonialsSectionModel>("TestimonialsSection", ContentId) ?? GetTestimonialsSection();
    }
    private TestimonialsSectionModel GetTestimonialsSection()
    {
        return new TestimonialsSectionModel
        {
            SectionTitle = "Testimonials",
            SectionSubtitle = "What clients and reviewers say about my work.",

            Critics = new List<CriticReview>
            {
                new CriticReview
                {
                    Source = "The New York Times",
                    Quote = "A thoughtful craftsperson who delivers polished, performant experiences.",
                    Rating = 5
                },
                new CriticReview
                {
                    Source = "Washington Post",
                    Quote = "Clear communication, strong process, and an eye for detail.",
                    Rating = 4.5
                },
                new CriticReview
                {
                    Source = "The Guardian",
                    Quote = "Design and engineering come together seamlessly in the final product.",
                    Rating = 5
                }
            },

            Testimonials = new List<TestimonialItem>
            {
                new TestimonialItem
                {
                    Name = "Jane Smith",
                    Title = "Product Lead",
                    ImageUrl = "assets/img/person/person-f-1.webp",
                    Review = "Exceptional partner from discovery through launch. We shipped on time and exceeded our performance goals.",
                    Rating = 5
                },
                new TestimonialItem
                {
                    Name = "Michael Johnson",
                    Title = "Engineering Manager",
                    ImageUrl = "assets/img/person/person-m-2.webp",
                    Review = "Clean, maintainable code and pragmatic architecture. The handoff to our team was smooth.",
                    Rating = 5
                },
                new TestimonialItem
                {
                    Name = "Emily Davis",
                    Title = "Founder",
                    ImageUrl = "assets/img/person/person-f-3.webp",
                    Review = "Turned a rough concept into a crisp product. Great collaboration and initiative throughout.",
                    Rating = 4.5
                },
                new TestimonialItem
                {
                    Name = "Robert Wilson",
                    Title = "Marketing Director",
                    ImageUrl = "assets/img/person/person-m-4.webp",
                    Review = "Striking design, fast pages, and measurable results. Would gladly work together again.",
                    Rating = 5
                }
            },

            Summary = new OverallRating
            {
                AverageRating = 4.8,
                ReviewCount = 230,
                Platforms = new() { "Goodreads", "Amazon", "Barnes & Noble" }
            }
        };
    }
}


<script>
    function initSwiper() {
      document.querySelectorAll(".init-swiper").forEach(function(swiperElement) {
        let config = JSON.parse(
          swiperElement.querySelector(".swiper-config").innerHTML.trim()
        );

        if (swiperElement.classList.contains("swiper-tab")) {
          initSwiperWithCustomPagination(swiperElement, config);
        } else {
          new Swiper(swiperElement, config);
        }
      });
    }
    initSwiper();
</script>